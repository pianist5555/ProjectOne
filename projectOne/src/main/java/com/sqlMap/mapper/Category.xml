<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="Member">
   <select id="getCount" resultType="int">
      SELECT count(*) 
      FROM MEMBERS
   </select>


<!-- property = java 변수명 , column = db컬럼명 -->
<!--  resultmap에 type는 myBatis Configuration에서 축약해서 정의 member -> spms.vo.Member  -->
   <resultMap id="resultGetList" type="member">
      <result property="no" column="mno" />
      <result property="name" column="mname" />
      <result property="email" column="email" />
      <!--  java.sql.Date는 날짜만, java.util.Date는 시분초까지 포함 -->
      <result property="createdDate" column="cre_date" javaType="java.sql.Date"/>
      <result property="modifiedDate" column="mod_date" javaType="java.sql.Date"/>   
   </resultMap>

   
   <select id="selectList" resultMap="resultGetList">
      SELECT MNO,MNAME,EMAIL,PWD,CRE_DATE,MOD_DATE
      FROM MEMBERS 
      ORDER BY MNO ASC   
   </select>
   
   <!--  as를 통한 치환도 가능하다. -->   
   <select id="selectList2" resultType="member">
      SELECT MNO as no , MNAME as name , EMAIL as email , CRE_DATE as createdDate ,
            PWD as password , MOD_DATE as modifiedDate 
      FROM MEMBERS 
      ORDER BY MNO ASC   
   </select>
   
   <insert id="insert" parameterType="member">
      INSERT INTO MEMBERS(MNO,EMAIL,PWD,MNAME,CRE_DATE,MOD_DATE) 
      VALUES (tmpseq.nextval,#{email},#{password},#{name},sysdate,sysdate)   
   </insert>
   
   <delete id="delete" parameterType="int">
      DELETE FROM MEMBERS WHERE mno=#{no}
   </delete>
   
   <select id="selectOne" parameterType="int" resultMap="resultGetList" >
      SELECT MNO,MNAME,EMAIL,PWD,CRE_DATE,MOD_DATE
      FROM MEMBERS 
      WHERE mno = #{no}
   </select>
   
   <update id="update" parameterType="member">
      UPDATE MEMBERS SET EMAIL=#{email}, MNAME=#{name}, MOD_DATE=sysdate where MNO=#{no}
   </update>
   
   <select id="exist" parameterType="map" resultMap="resultGetList">
      SELECT MNAME,EMAIL from MEMBERS where EMAIL=#{email} and PWD=#{password}
   </select>
   
   <select id="checkEmail" parameterType="String" resultType="String">
      select MNAME from MEMBERS where EMAIL=#{email} and ROWNUM=1
   </select>
   
   <delete id="mulDelete" parameterType="Map">
   	DELETE FROM MEMBERS WHERE MNO IN
   	<foreach collection="nos" item="no" open="(" close=")" separator=",">
   		#{no}
   	</foreach>
   </delete>
</mapper>